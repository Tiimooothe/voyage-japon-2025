<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Voyage Japon</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>    

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: sans-serif;
  }

  /* ===== Mobile-first par défaut ===== */
  #map {
    height: 60vh; /* 60% de la hauteur écran */
    width: 100%;
  }

  #planning {
    height: 40vh; /* 40% de la hauteur écran */
    overflow-y: auto;
    padding: 0.5em;
    background: #f8f8f8;
    font-size: 30px;
  }

  .day { margin-bottom: 1em; }
  .activity { cursor: pointer; margin: 0.2em 0; color: blue; text-decoration: underline; font-size: 28px; }
  
  body, #planning {
  -webkit-text-size-adjust: 100%; /* empêche Safari de réduire la taille */
  }

  /* ===== Desktop si écran large ===== */
  /* @media (min-width: 1024px) {
    body {
      display: flex;
      flex-direction: row;
      height: 100vh;
    }
    #map {
      width: 70%;
      height: 100%;
    }
    #planning {
      width: 30%;
      height: 100%;
    }
  } */
</style>

</head>
<body>
  <div id="map"></div>
  <div id="planning" id="planning"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // ------------------------------
    // 1. Définir l'itinéraire ici
    // ------------------------------
    var itinerary = [
      {
        day: "Jour 2 - Mardi 16 septembre 2025 - Osaka",
        color: "blue",
        activities: [
          { name: "10h20 - Kansai International Airport", marker: true, coords: [34.4342, 135.2444], description: "" },
          { name: "Quartier de Shinsekai", marker: true, coords: [34.6525, 135.5067], description: "" },
          { name: "Déjeuner dans un restaurant local", marker: false, coords: [34.6937, 135.5023], description: "" },
          { name: "Rue de Dotombori", marker: true, coords: [34.6687, 135.5018], description: "" },
          { name: "Umeda Sky Building", marker: true, coords: [34.7054, 135.4899], description: "" },
          { name: "19h00 : Diner et nuit à l'hôtel", marker: false, coords: [34.6937, 135.5023], description: "" }
        ]
      },
      {
        day: "Jour 3 - Mercredi 17 septembre 2025 - Osaka",
        color: "green",
        activities: [
          { name: "(Gros) Petit déjeuner à l’hôtel", marker: false, coords: [34.6937, 135.5023], description: "" },
          { name: "12h Exposition universelle (porte est)", marker: true, coords: [34.650559719127564, 135.38964039430834], description: "" },
          { name: "Diner dans l'expo", marker: false, coords: [34.650559719127564, 135.38964039430834], description: "" },
          { name: "~22h00 Retour à l'hôtel", marker: false, coords: [34.6937, 135.5023], description: "" },
          { name: "Diner et nuit à l'hôtel", marker: false, coords: [34.6937, 135.5023], description: "" }
        ]
      },
      {
        day: "Jour 4 - Jeudi 18 septembre 2025 - Osaka / Nara / Kyoto",
        color: "yellow",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [34.6937, 135.5023], description: "" },
          { name: "9h00 autocar Nara", marker: false, coords: [34.6937, 135.5023], description: "" },
          { name: "Todai-ji", marker: true, coords: [34.68910980040688, 135.8399950170622], description: "" },
          { name: "Parc aux daims", marker: true, coords: [34.68524106203164, 135.84305491140404], description: "" },
          { name: "13h00 : déjeuner dans un restaurant local", marker: false, coords: [34.6851, 135.8048], description: "" },
          { name: "Kasuga Taisha", marker: true, coords: [34.681889190765645, 135.84872315741273], description: "" },
          { name: "Transfère pout Kyoto", marker: false, coords: [35.0116, 135.7681], description: "" },
          { name: "Fushimi Inari", marker: true, coords: [34.96785270028562, 135.7792784543481], description: "" },
          { name: "19h Diner dan restaurant local et nuit à l'hôtel", marker: false, coords: [35.0116, 135.7681], description: "" }
        ]
      },
      {
        day: "Jour 5 - Vendredi 19 septembre 2025 - Kyoto",
        color: "red",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [35.0116, 135.7681], description: "" },
          { name: "9h00 départ avec guide - transport en communs", marker: false, coords: [35.0116, 135.7681], description: "" },
          { name: "Kinkaku-ji", marker: true, coords: [35.0394, 135.7292], description: "" },
          { name: "Marché de Nishiki", marker: true, coords: [35.0051583399787, 135.76495052044555], description: "" },
          { name: "13h00 Déjeuner dans un restaurant local", marker: false, coords: [35.0116, 135.7681], description: "" },
          { name: "Kiyomizu-dera", marker: true, coords: [34.9949, 135.7850], description: "" },
          { name: "Temps libre - Ruelles Ninenzaka et Sannenzaka", marker: true, coords: [34.99765677876538, 135.78097179974077], description: "" },
          { name: "Quartier de Gion", marker: true, coords: [35.00447995911696, 135.7751794695655], description: "" },
          { name: "19h00 Diner dans un restaurant local et nuit à l'hôtel", marker: false, coords: [35.0116, 135.7681], description: "" }
        ]
      },
      {
        day: "Jour 6 - Samedi 20 septembre 2025 - Kyoto / Amanohashidate",
        color: "orange",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [35.0116, 135.7681], description: "" },
          { name: "08h00 - départ en autocar privatisé pour Amanohashidate", marker: false, coords: [35.0116, 135.7681], description: "" },
          { name: "Temple Nariaiji", marker: true, coords: [35.59574813788166, 135.18675322913217], description: "" },
          { name: "Observatoire Bentensan", marker: true, coords: [35.586480353504356, 135.1957345896591], description: "" },
          { name: "Déjeuner dans un restaurant local", marker: false, coords: [35.5635, 135.1855], description: "" },
          { name: "Kono-jinja", marker: true, coords: [35.582941023083116, 135.19680974175515], description: "" },
          { name: "Bateau promenade sur le lagon d’Aso", marker: true, coords: [35.5682390910198, 135.17845163169076], description: "" },
          { name: "Parc Amanohashidate View Land", marker: true, coords: [35.55219115147157, 135.18135612493322], description: "" },
          { name: "Diner et nuit à l'hôtel (service 17h30 / 21h)", marker: false, coords: [35.5635, 135.1855], description: "" }
        ]
      },
      {
        day: "Jour 7 - Dimanche 21 septembre 2025 - Amanohashidate / Kanazawa",
        color: "violet",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [35.5635, 135.1855], description: "" },
          { name: "08h00 - départ autocar Kanazawa (260km - 4h avec 1 pause de 20min)", marker: false, coords: [35.5635, 135.1855], description: "" },
          { name: "13h00 : déjeuner dans un restaurant local", marker: false, coords: [36.5613, 136.6562], description: "" },
          { name: "Jardin Kenrokuen", marker: true, coords: [36.5613, 136.6620], description: "" },
          { name: "Quartier Higashi-Chaya", marker: true, coords: [36.57276341560346, 136.66713945328752], description: "" },
          { name: "16h - Maison Shima", marker: true, coords: [36.57266858047925, 136.6668390456762], description: "" },
          { name: "19h Diner dans un restaurant local et nuit a l'hôtel", marker: false, coords: [36.5613, 136.6562], description: "" }
        ]
      },
      {
        day: "Jour 8 - Lundi 22 septembre 2025 - Kanazawa / Shirakawago / Takayama",
        color: "red",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [36.5613, 136.6562], description: "" },
          { name: "08h30 - départ autocar", marker: false, coords: [36.5613, 136.6562], description: "" },
          { name: "Quartier de Nagamachi", marker: true, coords: [36.56556888328675, 136.64908296817617], description: "" },
          { name: "9h30 - Maison Nomura", marker: true, coords: [36.56446029579407, 136.65052154063298], description: "" },
          { name: "Marché Omicho", marker: true, coords: [36.5718196367882, 136.6560582151906], description: "" },
          { name: "autocar privatisé pour Shirakawago (76km, 1h20 - sans pause)", marker: false, coords: [36.5613, 136.6562], description: "" },
          { name: "12h45 : déjeuner dans un restaurant local", marker: false, coords: [36.2593, 136.8969], description: "" },
          { name: "Shirakawago - Observatoire Shiroyama", marker: true, coords: [36.263262513339775, 136.90925427574177], description: "" },
          { name: "Promenade libre dans Shirakawago", marker: true, coords: [36.27362421155837, 136.89962263601112], description: "" },
          { name: "autocar privatisé vers Takayama (env. 49km, 1h – sans pause)", marker: false, coords: [36.2593, 136.8969], description: "" },
          { name: "19h diner dans un restaurant local et nuit à l'hotêl", marker: false, coords: [36.1460, 137.2523], description: "" }
        ]
      },
      {
        day: "Jour 9 - Mardi 23 septembre 2025 - Takayama / Matsumoto / Kawaguchiko",
        color: "green",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [36.1460, 137.2523], description: "" },
          { name: "08h30 - départ à pied", marker: false, coords: [36.1460, 137.2523], description: "" },
          { name: "08h45 Takayama Jinya", marker: true, coords: [36.13973514537589, 137.25784053051544], description: "" },
          { name: "Vieux quartier et rue Sannomachi", marker: true, coords: [36.141472028437526, 137.25962269612313], description: "" },
          { name: "10h30 récupération des bagages à l’hôtel et autocar pour Matsumoto", marker: false, coords: [36.1460, 137.2523], description: "" },
          { name: "Fabrique de miso à Matsumoto", marker: true, coords: [36.22898661719126, 137.97636699899263], description: "" },
          { name: "13h00 : déjeuner dans un restaurant local", marker: false, coords: [36.2381, 137.9716], description: "" },
          { name: "14h30 : Château de Matsumoto", marker: true, coords: [36.23879142778446, 137.96866354824292], description: "" },
          { name: "Départ pour Kawaguchiko (140km, 2h40 - avec une pause de 20min)", marker: false, coords: [36.2381, 137.9716], description: "" },
          { name: "Diner et nuit à l'hôtel", marker: false, coords: [35.5000, 138.7670], description: "" }
        ]
      },
      {
        day: "Jour 10 - Mercredi 24 septembre 2025 - Kawaguchiko / Tokyo",
        color: "blue",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [35.5000, 138.7670], description: "" },
          { name: "08h30 - départ en autocar", marker: false, coords: [35.5000, 138.7670], description: "" },
          { name: "Promenade libre bord du lac Kawaguchi", marker: true, coords: [35.51451518165198, 138.74047477058838], description: "" },
          { name: "10h00 Croisière sur le lac Kawaguchi", marker: true, coords: [35.51605467643915, 138.75659303901014], description: "" },
          { name: "Mont Kachi Kachi (téléphérique 3min ou randonnée ~1h)", marker: true, coords: [35.50415434958453, 138.7721109537672], description: "" },
          { name: "12h00 : déjeuner dans un restaurant local", marker: false, coords: [35.5000, 138.7670], description: "" },
          { name: "Départ pour Tokyo", marker: false, coords: [35.5000, 138.7670], description: "" },
          { name: "Quartier d'Asakusa", marker: true, coords: [35.716339291969845, 139.79651166459195], description: "" },
          { name: "19h Diner et nuit à l'hôtel", marker: false, coords: [35.6828, 139.7595], description: "" }
        ]
      },
      {
        day: "Jour 11 - Jeudi 25 septembre 2025 - Tokyo",
        color: "orange",
        activities: [
          { name: "Petit déjeuner à l’hôtel", marker: false, coords: [35.6828, 139.7595], description: "" },
          { name: "09h00 - départ journée transports en communs", marker: false, coords: [35.6828, 139.7595], description: "" },
          { name: "Mairie de Tokyo", marker: true, coords: [35.68985822545646, 139.691532086949], description: "" },
          { name: "Meiji Jingu", marker: true, coords: [35.676563162917546, 139.69970140536358], description: "" },
          { name: "12h00 : déjeuner dans un restaurant local", marker: false, coords: [35.6828, 139.7595], description: "" },
          { name: "Harajuku", marker: true, coords: [35.6694630221658, 139.70898598052773], description: "" },
          { name: "Omotesando", marker: true, coords: [35.667468284113205, 139.70782882679046], description: "" },
          { name: "Quartier de Shibuya", marker: true, coords: [35.65962761591469, 139.70062393036832], description: "" },
          { name: "18h00 retour vers l'hotel", marker: false, coords: [35.6828, 139.7595], description: "" },
          { name: "19h00 Diner et nuit à l'hôtel", marker: false, coords: [35.6828, 139.7595], description: "" }
        ]
      },
      {
        day: "Jour 12 - Vendredi 26 septembre 2025 - Tokyo / Paris",
        color: "red",
        activities: [
          { name: "Petit-déjeuner à l'hôtel", marker: false, coords: [35.6828, 139.7595], description: "" },
          { name: "Journée libre", marker: false, coords: [35.6828, 139.7595], description: "" },
          { name: "18h00 transfert vers l'aéroport de Tokyo Haneda", marker: true, coords: [35.55060743473522, 139.77904224448775], description: "" },
          { name: "22h05 Vol AF 279 pour Paris", marker: false, coords: [35.55060743473522, 139.77904224448775], description: "" }
        ]
      }
    ];

    // ------------------------------
    // 2. Initialiser la carte
    // ------------------------------
    var map = L.map('map').setView([36.0, 138.0], 7); 

    L.tileLayer('https://{s}.tile.jawg.io/jawg-streets/{z}/{x}/{y}.png?access-token=3eaQhPf2daIUX3JcZLPm2YFXBtxgxpRnAhkqY0oIPRdBaOULWnHpKZtEFBd4VlD6', {
      attribution: '&copy; Jawg Maps | &copy; OpenStreetMap contributors',
      subdomains: ['a','b','c'],
      maxZoom: 20,
      tileSize: 512,
      zoomOffset: -1
    }).addTo(map);

    map.invalidateSize();

    window.addEventListener('resize', function() {
      map.invalidateSize();
    });

    var markers = [];

    // ------------------------------
    // 3. Générer les markers et popups
    // ------------------------------
    function createIcon(color) {
      return L.icon({
        iconUrl: `https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-${color}.png`,
        shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      });
    }

    itinerary.forEach(day => {
      day.activities.forEach(act => {
        if (act.marker) {
          var marker = L.marker(act.coords, { icon: createIcon(day.color) }).addTo(map)
                        .bindPopup("<div style='font-size:24px;'><b>" + act.name + "</b><br>" + act.description);
          markers.push({ coords: act.coords, marker: marker });
        }
      });
    });

    // ------------------------------
    // 4. Générer le planning dans la colonne
    // ------------------------------
    var planningDiv = document.getElementById("planning");

    itinerary.forEach(day => {
      var dayDiv = document.createElement("div");
      dayDiv.className = "day";

      var dayTitle = document.createElement("h3");
      dayTitle.textContent = day.day;
      dayDiv.appendChild(dayTitle);

      day.activities.forEach(act => {
        var actDiv = document.createElement("div");
        actDiv.className = "activity";
        actDiv.textContent = act.name;
        actDiv.onclick = function() { goTo(act.coords[0], act.coords[1]); };
        dayDiv.appendChild(actDiv);
      });

      planningDiv.appendChild(dayDiv);
    });

    // ------------------------------
    // 5. Fonction pour recentrer + ouvrir popup
    // ------------------------------
    function goTo(lat, lng) {
      map.setView([lat, lng], 12);
      var markerObj = markers.find(m => m.coords[0] === lat && m.coords[1] === lng);
      if(markerObj) markerObj.marker.openPopup();
    }

  </script>
</body>
</html>
